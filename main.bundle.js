(()=>{"use strict";const t="list",e={openWeather:"api.openweathermap.org",sypExGeo:"api.sypexgeo.net",ipApi:"ipapi.co"};function n(t,e){return Boolean(t)?e:()=>{}}const o=[];async function a(){const t=await async function(){const t=await fetch(`https://${e.ipApi}/json/`),n=(await t.json()).ip;return console.log(n),n}(),{cityName:n,ll:o}=await async function(t){const n=await fetch(`https://${e.sypExGeo}/json/${t}`),o=await n.json();console.log(o.city.lat,o.city.lon,o.city.name_ru);const a=o.city.name_ru,c=o.city.lon+","+o.city.lat;return console.log(c),{cityName:a,ll:c}}(t);c(n),i(o)}async function c(t){const n=`https://${e.openWeather}/data/2.5/weather?q=${t}&appid=6dac2d983c4b4bff9266414437d14d5e`,o=await fetch(n),a=await o.json();if(!a.weather)return!1;console.log(a.weather[0].description,a.main.temp,a.weather[0].icon);const c=`${a.main.temp}`,i=Number(c),s=Math.round(i-273.15);return document.getElementById("temperature").innerText=`${s}Â°C`,document.getElementById("weatherDescription").textContent=a.weather[0].description,document.getElementById("city").innerText=`${a.name}`,document.getElementById("weatherImage").src=`https://openweathermap.org/img/wn/${a.weather[0].icon}@2x.png`,!0}function i(t){document.getElementById("map").src=`https://static-maps.yandex.ru/v1?ll=${t}&spn=0.016457,0.00619&apikey=220bcecd-2e57-4af8-9150-e82755be7199`}async function s(t){const n=`https://${e.openWeather}/data/2.5/weather?q=${t}&appid=6dac2d983c4b4bff9266414437d14d5e`,o=await fetch(n),a=await o.json();return console.log(a.coord.lon,a.coord.lat,a.name),a.coord.lon+","+a.coord.lat}function r(t){n("Enter"===t.key,l)()}async function l(){const e=document.getElementById(t),n=document.getElementById("input"),a=n.value;if(n.value="",await c(a)){s(a).then((t=>i(t)));const t=document.createElement("li");t.setAttribute("data-city",a),t.innerHTML=a,e.append(t),o.push(a),console.log(o),localStorage.setItem("cities",JSON.stringify(o)),e.childElementCount>10&&(e.childNodes[0].remove(),o.shift(),localStorage.setItem("cities",JSON.stringify(o)))}}async function d(t){if(t.target.dataset&&t.target.dataset.city){const e=t.target.dataset.city;await c(e),s(e).then((t=>i(t)))}}n(!window.jest,(async function(){null===localStorage.getItem("cities")?a():(a(),async function(){const e=JSON.parse(localStorage.getItem("cities"));console.log(e);const n=document.getElementById(t);for(let t=0;t<e.length;t++){const a=e[t],c=document.createElement("li");c.setAttribute("data-city",a),c.innerHTML=a,n.append(c),o.push(a)}}()),document.getElementById("button").addEventListener("click",l),document.getElementById("input").addEventListener("keydown",r),document.getElementById(t).addEventListener("click",d)}))()})();